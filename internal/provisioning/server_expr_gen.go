// Code generated by generate-expr. DO NOT EDIT.

package provisioning

import (
	"time"

	"github.com/FuturFusion/operations-center/shared/api"
	osapi "github.com/lxc/incus-os/incus-osd/api"
)

type ExprApiApplicationVersionData struct {
	Name             string  `json:"name" yaml:"name" expr:"name"`
	Version          string  `json:"version" yaml:"version" expr:"version"`
	AvailableVersion *string `json:"available_version,omitempty" yaml:"available_version,omitempty" expr:"available_version"`
	NeedsUpdate      *bool   `json:"needs_update,omitempty" yaml:"needs_update,omitempty" expr:"needs_update"`
	InMaintenance    bool    `json:"in_maintenance" yaml:"in_maintenance" expr:"in_maintenance"`
}

type ExprApiOSData struct {
	Network  ExprOsapiSystemNetwork  `json:"network" yaml:"network" expr:"network"`
	Security ExprOsapiSystemSecurity `json:"security" yaml:"security" expr:"security"`
	Storage  ExprOsapiSystemStorage  `json:"storage" yaml:"storage" expr:"storage"`
}

type ExprApiOSVersionData struct {
	Name             string  `json:"name" yaml:"name" expr:"name"`
	Version          string  `json:"version" yaml:"version" expr:"version"`
	VersionNext      string  `json:"version_next" yaml:"version_next" expr:"version_next"`
	AvailableVersion *string `json:"available_version,omitempty" yaml:"available_version,omitempty" expr:"available_version"`
	NeedsReboot      bool    `json:"needs_reboot" yaml:"needs_reboot" expr:"needs_reboot"`
	NeedsUpdate      *bool   `json:"needs_update,omitempty" yaml:"needs_update,omitempty" expr:"needs_update"`
}

type ExprApiServerVersionData struct {
	OS            ExprApiOSVersionData            `json:"os" yaml:"os" expr:"os"`
	Applications  []ExprApiApplicationVersionData `json:"applications" yaml:"applications" expr:"applications"`
	UpdateChannel string                          `json:"update_channel" yaml:"update_channel" expr:"update_channel"`
	NeedsUpdate   *bool                           `json:"needs_update,omitempty" yaml:"needs_update" expr:"needs_update"`
	NeedsReboot   *bool                           `json:"needs_reboot,omitempty" yaml:"needs_reboot" expr:"needs_reboot"`
	InMaintenance *bool                           `json:"in_maintenance,omitempty" yaml:"in_maintenance" expr:"in_maintenance"`
}

type ExprOsapiSystemNetwork struct {
	Config *ExprOsapiSystemNetworkConfig `json:"config" yaml:"config" expr:"config"`
	State  ExprOsapiSystemNetworkState   `incusos:"-" json:"state" yaml:"state" expr:"state"`
}

type ExprOsapiSystemNetworkBond struct {
	Addresses         []string                             `json:"addresses,omitempty"           yaml:"addresses,omitempty" expr:"addresses"`
	Ethernet          *ExprOsapiSystemNetworkEthernet      `json:"ethernet,omitempty"            yaml:"ethernet,omitempty" expr:"ethernet"`
	FirewallRules     []ExprOsapiSystemNetworkFirewallRule `json:"firewall_rules,omitempty"      yaml:"firewall_rules,omitempty" expr:"firewall_rules"`
	Hwaddr            string                               `json:"hwaddr,omitempty"              yaml:"hwaddr,omitempty" expr:"hwaddr"`
	LLDP              bool                                 `json:"lldp,omitempty"                yaml:"lldp,omitempty" expr:"lldp"`
	Members           []string                             `json:"members,omitempty"             yaml:"members,omitempty" expr:"members"`
	Mode              string                               `json:"mode"                          yaml:"mode" expr:"mode"`
	MTU               int                                  `json:"mtu,omitempty"                 yaml:"mtu,omitempty" expr:"mtu"`
	Name              string                               `json:"name"                          yaml:"name" expr:"name"`
	RequiredForOnline string                               `json:"required_for_online,omitempty" yaml:"required_for_online,omitempty" expr:"required_for_online"`
	Roles             []string                             `json:"roles,omitempty"               yaml:"roles,omitempty" expr:"roles"`
	Routes            []ExprOsapiSystemNetworkRoute        `json:"routes,omitempty"              yaml:"routes,omitempty" expr:"routes"`
	VLANTags          []int                                `json:"vlan_tags,omitempty"           yaml:"vlan_tags,omitempty" expr:"vlan_tags"`
}

type ExprOsapiSystemNetworkConfig struct {
	DNS        *ExprOsapiSystemNetworkDNS        `json:"dns,omitempty"   yaml:"dns,omitempty" expr:"dns"`
	Time       *ExprOsapiSystemNetworkTime       `json:"time,omitempty"  yaml:"time,omitempty" expr:"time"`
	Proxy      *ExprOsapiSystemNetworkProxy      `json:"proxy,omitempty" yaml:"proxy,omitempty" expr:"proxy"`
	Interfaces []ExprOsapiSystemNetworkInterface `json:"interfaces,omitempty" yaml:"interfaces,omitempty" expr:"interfaces"`
	Bonds      []ExprOsapiSystemNetworkBond      `json:"bonds,omitempty"      yaml:"bonds,omitempty" expr:"bonds"`
	VLANs      []ExprOsapiSystemNetworkVLAN      `json:"vlans,omitempty"      yaml:"vlans,omitempty" expr:"vlans"`
	Wireguard  []ExprOsapiSystemNetworkWireguard `json:"wireguard,omitempty"  yaml:"wireguard,omitempty" expr:"wireguard"`
}

type ExprOsapiSystemNetworkDNS struct {
	Domain        string   `json:"domain"                   yaml:"domain" expr:"domain"`
	Hostname      string   `json:"hostname"                 yaml:"hostname" expr:"hostname"`
	Nameservers   []string `json:"nameservers,omitempty"    yaml:"nameservers,omitempty" expr:"nameservers"`
	SearchDomains []string `json:"search_domains,omitempty" yaml:"search_domains,omitempty" expr:"search_domains"`
}

type ExprOsapiSystemNetworkEthernet struct {
	DisableEnergyEfficient bool     `json:"disable_energy_efficient,omitempty" yaml:"disable_energy_efficient,omitempty" expr:"disable_energy_efficient"`
	DisableGRO             bool     `json:"disable_gro,omitempty"              yaml:"disable_gro,omitempty" expr:"disable_gro"`
	DisableGSO             bool     `json:"disable_gso,omitempty"              yaml:"disable_gso,omitempty" expr:"disable_gso"`
	DisableIPv4TSO         bool     `json:"disable_ipv4_tso,omitempty"         yaml:"disable_ipv4_tso,omitempty" expr:"disable_ipv4_tso"`
	DisableIPv6TSO         bool     `json:"disable_ipv6_tso,omitempty"         yaml:"disable_ipv6_tso,omitempty" expr:"disable_ipv6_tso"`
	WakeOnLAN              bool     `json:"wakeonlan,omitempty"                yaml:"wakeonlan,omitempty" expr:"wakeonlan"`
	WakeOnLANModes         []string `json:"wakeonlan_modes,omitempty"          yaml:"wakeonlan_modes,omitempty" expr:"wakeonlan_modes"`
	WakeOnLANPassword      string   `json:"wakeonlan_password,omitempty"       yaml:"wakeonlan_password,omitempty" expr:"wakeonlan_password"`
}

type ExprOsapiSystemNetworkFirewallRule struct {
	Action   string `json:"action"             yaml:"action" expr:"action"`
	Source   string `json:"source,omitempty"   yaml:"source,omitempty" expr:"source"`
	Protocol string `json:"protocol,omitempty" yaml:"protocol,omitempty" expr:"protocol"`
	Port     int    `json:"port,omitempty"     yaml:"port,omitempty" expr:"port"`
}

type ExprOsapiSystemNetworkInterface struct {
	Addresses         []string                             `json:"addresses,omitempty"           yaml:"addresses,omitempty" expr:"addresses"`
	Ethernet          *ExprOsapiSystemNetworkEthernet      `json:"ethernet,omitempty"            yaml:"ethernet,omitempty" expr:"ethernet"`
	FirewallRules     []ExprOsapiSystemNetworkFirewallRule `json:"firewall_rules,omitempty"      yaml:"firewall_rules,omitempty" expr:"firewall_rules"`
	Hwaddr            string                               `json:"hwaddr"                        yaml:"hwaddr" expr:"hwaddr"`
	LLDP              bool                                 `json:"lldp,omitempty"                yaml:"lldp,omitempty" expr:"lldp"`
	MTU               int                                  `json:"mtu,omitempty"                 yaml:"mtu,omitempty" expr:"mtu"`
	Name              string                               `json:"name"                          yaml:"name" expr:"name"`
	RequiredForOnline string                               `json:"required_for_online,omitempty" yaml:"required_for_online,omitempty" expr:"required_for_online"`
	Roles             []string                             `json:"roles,omitempty"               yaml:"roles,omitempty" expr:"roles"`
	Routes            []ExprOsapiSystemNetworkRoute        `json:"routes,omitempty"              yaml:"routes,omitempty" expr:"routes"`
	StrictHwaddr      bool                                 `json:"strict_hwaddr,omitempty"       yaml:"strict_hwaddr,omitempty" expr:"strict_hwaddr"`
	VLANTags          []int                                `json:"vlan_tags,omitempty"           yaml:"vlan_tags,omitempty" expr:"vlan_tags"`
}

type ExprOsapiSystemNetworkInterfaceState struct {
	Addresses []string                                        `json:"addresses,omitempty" yaml:"addresses,omitempty" expr:"addresses"`
	Hwaddr    string                                          `json:"hwaddr,omitempty"    yaml:"hwaddr,omitempty" expr:"hwaddr"`
	LACP      *ExprOsapiSystemNetworkLACPState                `json:"lacp,omitempty"      yaml:"lacp,omitempty" expr:"lacp"`
	LLDP      []ExprOsapiSystemNetworkLLDPState               `json:"lldp,omitempty"      yaml:"lldp,omitempty" expr:"lldp"`
	Members   map[string]ExprOsapiSystemNetworkInterfaceState `json:"members,omitempty"   yaml:"members,omitempty" expr:"members"`
	MTU       int                                             `json:"mtu,omitempty"       yaml:"mtu,omitempty" expr:"mtu"`
	Roles     []string                                        `json:"roles,omitempty"     yaml:"roles,omitempty" expr:"roles"`
	Routes    []ExprOsapiSystemNetworkRoute                   `json:"routes,omitempty"    yaml:"routes,omitempty" expr:"routes"`
	Speed     string                                          `json:"speed,omitempty"     yaml:"speed,omitempty" expr:"speed"`
	State     string                                          `json:"state"               yaml:"state" expr:"state"`
	Stats     ExprOsapiSystemNetworkInterfaceStats            `json:"stats"               yaml:"stats" expr:"stats"`
	Type      string                                          `json:"type,omitempty"      yaml:"type,omitempty" expr:"type"`
	Wireguard *ExprOsapiSystemNetworkWireguardState           `json:"wireguard,omitempty" yaml:"wireguard,omitempty" expr:"wireguard"`
}

type ExprOsapiSystemNetworkInterfaceStats struct {
	RXBytes  int `json:"rx_bytes"  yaml:"rx_bytes" expr:"rx_bytes"`
	RXErrors int `json:"rx_errors" yaml:"rx_errors" expr:"rx_errors"`
	TXBytes  int `json:"tx_bytes"  yaml:"tx_bytes" expr:"tx_bytes"`
	TXErrors int `json:"tx_errors" yaml:"tx_errors" expr:"tx_errors"`
}

type ExprOsapiSystemNetworkLACPState struct {
	LocalMAC  string `json:"local_mac"  yaml:"local_mac" expr:"local_mac"`
	RemoteMAC string `json:"remote_mac" yaml:"remote_mac" expr:"remote_mac"`
}

type ExprOsapiSystemNetworkLLDPState struct {
	ChassisID string `json:"chassis_id"     yaml:"chassis_id" expr:"chassis_id"`
	Name      string `json:"name"           yaml:"name" expr:"name"`
	PortID    string `json:"port_id"        yaml:"port_id" expr:"port_id"`
	Port      string `json:"port,omitempty" yaml:"port,omitempty" expr:"port"`
}

type ExprOsapiSystemNetworkProxy struct {
	Rules   []ExprOsapiSystemNetworkProxyRule            `json:"rules,omitempty"   yaml:"rules,omitempty" expr:"rules"`
	Servers map[string]ExprOsapiSystemNetworkProxyServer `json:"servers,omitempty" yaml:"servers,omitempty" expr:"servers"`
}

type ExprOsapiSystemNetworkProxyRule struct {
	Destination string `json:"destination" yaml:"destination" expr:"destination"`
	Target      string `json:"target"      yaml:"target" expr:"target"`
}

type ExprOsapiSystemNetworkProxyServer struct {
	Auth     string `json:"auth"               yaml:"auth" expr:"auth"`
	Host     string `json:"host"               yaml:"host" expr:"host"`
	Password string `json:"password,omitempty" yaml:"password,omitempty" expr:"password"`
	Realm    string `json:"realm,omitempty"    yaml:"realm,omitempty" expr:"realm"`
	Username string `json:"username,omitempty" yaml:"username,omitempty" expr:"username"`
	UseTLS   bool   `json:"use_tls"            yaml:"use_tls" expr:"use_tls"`
}

type ExprOsapiSystemNetworkRoute struct {
	To  string `json:"to"  yaml:"to" expr:"to"`
	Via string `json:"via" yaml:"via" expr:"via"`
}

type ExprOsapiSystemNetworkState struct {
	Interfaces map[string]ExprOsapiSystemNetworkInterfaceState `json:"interfaces" yaml:"interfaces" expr:"interfaces"`
}

type ExprOsapiSystemNetworkTime struct {
	NTPServers []string `json:"ntp_servers,omitempty" yaml:"ntp_servers,omitempty" expr:"ntp_servers"`
	Timezone   string   `json:"timezone,omitempty"    yaml:"timezone,omitempty" expr:"timezone"`
}

type ExprOsapiSystemNetworkVLAN struct {
	Addresses         []string                             `json:"addresses,omitempty"           yaml:"addresses,omitempty" expr:"addresses"`
	FirewallRules     []ExprOsapiSystemNetworkFirewallRule `json:"firewall_rules,omitempty"      yaml:"firewall_rules,omitempty" expr:"firewall_rules"`
	ID                int                                  `json:"id"                            yaml:"id" expr:"id"`
	MTU               int                                  `json:"mtu,omitempty"                 yaml:"mtu,omitempty" expr:"mtu"`
	Name              string                               `json:"name"                          yaml:"name" expr:"name"`
	Parent            string                               `json:"parent"                        yaml:"parent" expr:"parent"`
	RequiredForOnline string                               `json:"required_for_online,omitempty" yaml:"required_for_online,omitempty" expr:"required_for_online"`
	Roles             []string                             `json:"roles,omitempty"               yaml:"roles,omitempty" expr:"roles"`
	Routes            []ExprOsapiSystemNetworkRoute        `json:"routes,omitempty"              yaml:"routes,omitempty" expr:"routes"`
}

type ExprOsapiSystemNetworkWireguard struct {
	Addresses         []string                              `json:"addresses,omitempty"           yaml:"addresses,omitempty" expr:"addresses"`
	FirewallRules     []ExprOsapiSystemNetworkFirewallRule  `json:"firewall_rules,omitempty"      yaml:"firewall_rules,omitempty" expr:"firewall_rules"`
	MTU               int                                   `json:"mtu,omitempty"                 yaml:"mtu,omitempty" expr:"mtu"`
	Name              string                                `json:"name"                          yaml:"name" expr:"name"`
	Peers             []ExprOsapiSystemNetworkWireguardPeer `json:"peers,omitempty"               yaml:"peers,omitempty" expr:"peers"`
	Port              int                                   `json:"port,omitempty"                yaml:"port,omitempty" expr:"port"`
	PrivateKey        string                                `json:"private_key,omitempty"         yaml:"private_key,omitempty" expr:"private_key"`
	RequiredForOnline string                                `json:"required_for_online,omitempty" yaml:"required_for_online,omitempty" expr:"required_for_online"`
	Roles             []string                              `json:"roles,omitempty"               yaml:"roles,omitempty" expr:"roles"`
	Routes            []ExprOsapiSystemNetworkRoute         `json:"routes,omitempty"              yaml:"routes,omitempty" expr:"routes"`
}

type ExprOsapiSystemNetworkWireguardPeer struct {
	AllowedIPs          []string `json:"allowed_ips"                    yaml:"allowed_ips" expr:"allowed_ips"`
	Endpoint            string   `json:"endpoint,omitempty"             yaml:"endpoint,omitempty" expr:"endpoint"`
	PersistentKeepalive int      `json:"persistent_keepalive,omitempty" yaml:"persistent_keepalive,omitempty" expr:"persistent_keepalive"`
	PresharedKey        string   `json:"preshared_key,omitempty"        yaml:"preshared_key,omitempty" expr:"preshared_key"`
	PublicKey           string   `json:"public_key"                     yaml:"public_key" expr:"public_key"`
}

type ExprOsapiSystemNetworkWireguardPeerState struct {
	AllowedIPs          []string                             `json:"allowed_ips"                    yaml:"allowed_ips" expr:"allowed_ips"`
	EndPoint            string                               `json:"endpoint"                       yaml:"endpoint" expr:"endpoint"`
	LatestHandshake     string                               `json:"latest_handshake,omitempty"     yaml:"latest_handshake,omitempty" expr:"latest_handshake"`
	PersistentKeepalive string                               `json:"persistent_keepalive,omitempty" yaml:"persistent_keepalive,omitempty" expr:"persistent_keepalive"`
	PublicKey           string                               `json:"public_key"                     yaml:"public_key" expr:"public_key"`
	Stats               ExprOsapiSystemNetworkInterfaceStats `json:"stats"                          yaml:"stats" expr:"stats"`
}

type ExprOsapiSystemNetworkWireguardState struct {
	ListeningPort int                                        `json:"listening_port,omitempty" yaml:"listening_port,omitempty" expr:"listening_port"`
	Peers         []ExprOsapiSystemNetworkWireguardPeerState `json:"peers,omitempty"          yaml:"peers,omitempty" expr:"peers"`
	PublicKey     string                                     `json:"public_key"               yaml:"public_key" expr:"public_key"`
}

type ExprOsapiSystemSecurity struct {
	Config ExprOsapiSystemSecurityConfig `json:"config" yaml:"config" expr:"config"`
	State  ExprOsapiSystemSecurityState  `json:"state" yaml:"state" expr:"state"`
}

type ExprOsapiSystemSecurityConfig struct {
	CustomCACerts          []string `json:"custom_ca_certs,omitempty" yaml:"custom_ca_certs,omitempty" expr:"custom_ca_certs"`
	EncryptionRecoveryKeys []string `json:"encryption_recovery_keys"  yaml:"encryption_recovery_keys" expr:"encryption_recovery_keys"`
}

type ExprOsapiSystemSecurityEncryptedVolume struct {
	Volume string `json:"volume" yaml:"volume" expr:"volume"`
	State  string `json:"state"  yaml:"state" expr:"state"`
}

type ExprOsapiSystemSecuritySecureBootCertificate struct {
	Type        string `json:"type"        yaml:"type" expr:"type"`
	Fingerprint string `json:"fingerprint" yaml:"fingerprint" expr:"fingerprint"`
	Subject     string `json:"subject"     yaml:"subject" expr:"subject"`
	Issuer      string `json:"issuer"      yaml:"issuer" expr:"issuer"`
}

type ExprOsapiSystemSecurityState struct {
	EncryptedVolumes                []ExprOsapiSystemSecurityEncryptedVolume       `incusos:"-"                               json:"encrypted_volumes"                  yaml:"encrypted_volumes" expr:"encrypted_volumes"`
	EncryptionRecoveryKeysRetrieved bool                                           `json:"encryption_recovery_keys_retrieved" yaml:"encryption_recovery_keys_retrieved" expr:"encryption_recovery_keys_retrieved"`
	DriveRecoveryKeys               map[string]string                              `incusos:"-"                               json:"drive_recovery_keys"                yaml:"drive_recovery_keys" expr:"drive_recovery_keys"`
	PoolRecoveryKeys                map[string]string                              `incusos:"-"                               json:"pool_recovery_keys"                 yaml:"pool_recovery_keys" expr:"pool_recovery_keys"`
	SecureBootCertificates          []ExprOsapiSystemSecuritySecureBootCertificate `incusos:"-"                               json:"secure_boot_certificates"           yaml:"secure_boot_certificates" expr:"secure_boot_certificates"`
	SecureBootEnabled               bool                                           `incusos:"-"                               json:"secure_boot_enabled"                yaml:"secure_boot_enabled" expr:"secure_boot_enabled"`
	SystemStateIsTrusted            bool                                           `incusos:"-"                               json:"system_state_is_trusted"            yaml:"system_state_is_trusted" expr:"system_state_is_trusted"`
	TPMStatus                       string                                         `incusos:"-"                               json:"tpm_status"                         yaml:"tpm_status" expr:"tpm_status"`
}

type ExprOsapiSystemStorage struct {
	Config ExprOsapiSystemStorageConfig `json:"config" yaml:"config" expr:"config"`
	State  ExprOsapiSystemStorageState  `incusos:"-" json:"state" yaml:"state" expr:"state"`
}

type ExprOsapiSystemStorageConfig struct {
	ScrubSchedule string                       `json:"scrub_schedule" yaml:"scrub_schedule" expr:"scrub_schedule"`
	Pools         []ExprOsapiSystemStoragePool `incusos:"-"           json:"pools,omitempty" yaml:"pools,omitempty" expr:"pools"`
}

type ExprOsapiSystemStorageDrive struct {
	ID              string                            `json:"id"                     yaml:"id" expr:"id"`
	ModelFamily     string                            `json:"model_family"           yaml:"model_family" expr:"model_family"`
	ModelName       string                            `json:"model_name"             yaml:"model_name" expr:"model_name"`
	SerialNumber    string                            `json:"serial_number"          yaml:"serial_number" expr:"serial_number"`
	Bus             string                            `json:"bus"                    yaml:"bus" expr:"bus"`
	CapacityInBytes int                               `json:"capacity_in_bytes"      yaml:"capacity_in_bytes" expr:"capacity_in_bytes"`
	Boot            bool                              `json:"boot"                   yaml:"boot" expr:"boot"`
	Removable       bool                              `json:"removable"              yaml:"removable" expr:"removable"`
	Remote          bool                              `json:"remote"                 yaml:"remote" expr:"remote"`
	WWN             string                            `json:"wwn,omitempty"          yaml:"wwn,omitempty" expr:"wwn"`
	SMART           *ExprOsapiSystemStorageDriveSMART `json:"smart,omitempty"        yaml:"smart,omitempty" expr:"smart"`
	MemberPool      string                            `json:"member_pool,omitempty"  yaml:"member_pool,omitempty" expr:"member_pool"`
	Encrypted       bool                              `json:"encrypted,omitempty"    yaml:"encrypted,omitempty" expr:"encrypted"`
	EncryptedID     string                            `json:"encrypted_id,omitempty" yaml:"encrypted_id,omitempty" expr:"encrypted_id"`
}

type ExprOsapiSystemStorageDriveSMART struct {
	Enabled            bool   `json:"enabled"         yaml:"enabled" expr:"enabled"`
	Passed             bool   `json:"passed"          yaml:"passed" expr:"passed"`
	Error              string `json:"error,omitempty" yaml:"error,omitempty" expr:"error"`
	PowerOnHours       int    `json:"power_on_hours,omitempty"      yaml:"power_on_hours,omitempty" expr:"power_on_hours"`
	DataUnitsRead      int    `json:"data_units_read,omitempty"     yaml:"data_units_read,omitempty" expr:"data_units_read"`
	DataUnitsWritten   int    `json:"data_units_written,omitempty"  yaml:"data_units_written,omitempty" expr:"data_units_written"`
	AvailableSpare     int    `json:"available_spare,omitempty"     yaml:"available_spare,omitempty" expr:"available_spare"`
	PercentageUsed     int    `json:"percentage_used,omitempty"     yaml:"percentage_used,omitempty" expr:"percentage_used"`
	RawReadErrorRate   int    `json:"raw_read_error_rate,omitempty" yaml:"raw_read_error_rate,omitempty" expr:"raw_read_error_rate"`
	SeekErrorRate      int    `json:"seek_error_rate,omitempty"     yaml:"seek_error_rate,omitempty" expr:"seek_error_rate"`
	ReallocatedSectors int    `json:"reallocated_sectors,omitempty" yaml:"reallocated_sectors,omitempty" expr:"reallocated_sectors"`
}

type ExprOsapiSystemStoragePool struct {
	Name                      string                                 `json:"name" yaml:"name" expr:"name"`
	Type                      string                                 `json:"type" yaml:"type" expr:"type"`
	Devices                   []string                               `json:"devices"         yaml:"devices" expr:"devices"`
	Cache                     []string                               `json:"cache,omitempty" yaml:"cache,omitempty" expr:"cache"`
	Log                       []string                               `json:"log,omitempty"   yaml:"log,omitempty" expr:"log"`
	State                     string                                 `json:"state"                         yaml:"state" expr:"state"`
	LastScrub                 *ExprOsapiSystemStoragePoolScrubStatus `json:"last_scrub,omitempty"          yaml:"last_scrub,omitempty,omitempty" expr:"last_scrub"`
	EncryptionKeyStatus       string                                 `json:"encryption_key_status"         yaml:"encryption_key_status" expr:"encryption_key_status"`
	DevicesDegraded           []string                               `json:"devices_degraded,omitempty"    yaml:"devices_degraded,omitempty" expr:"devices_degraded"`
	CacheDegraded             []string                               `json:"cache_degraded,omitempty"      yaml:"cache_degraded,omitempty" expr:"cache_degraded"`
	LogDegraded               []string                               `json:"log_degraded,omitempty"        yaml:"log_degraded,omitempty" expr:"log_degraded"`
	RawPoolSizeInBytes        int                                    `json:"raw_pool_size_in_bytes"        yaml:"raw_pool_size_in_bytes" expr:"raw_pool_size_in_bytes"`
	UsablePoolSizeInBytes     int                                    `json:"usable_pool_size_in_bytes"     yaml:"usable_pool_size_in_bytes" expr:"usable_pool_size_in_bytes"`
	PoolAllocatedSpaceInBytes int                                    `json:"pool_allocated_space_in_bytes" yaml:"pool_allocated_space_in_bytes" expr:"pool_allocated_space_in_bytes"`
	Volumes                   []ExprOsapiSystemStoragePoolVolume     `json:"volumes"                       yaml:"volumes" expr:"volumes"`
}

type ExprOsapiSystemStoragePoolScrubStatus struct {
	State     osapi.SystemStoragePoolScrubState `json:"state" expr:"state"`
	StartTime time.Time                         `json:"start_time" expr:"start_time"`
	EndTime   time.Time                         `json:"end_time" expr:"end_time"`
	Progress  string                            `json:"progress" expr:"progress"`
	Errors    int                               `json:"errors" expr:"errors"`
}

type ExprOsapiSystemStoragePoolVolume struct {
	Name         string `json:"name"           yaml:"name" expr:"name"`
	UsageInBytes int    `json:"usage_in_bytes" yaml:"usage_in_bytes" expr:"usage_in_bytes"`
	QuotaInBytes int    `json:"quota_in_bytes" yaml:"quota_in_bytes" expr:"quota_in_bytes"`
	Use          string `json:"use"            yaml:"use" expr:"use"`
}

type ExprOsapiSystemStorageState struct {
	Drives []ExprOsapiSystemStorageDrive `json:"drives" yaml:"drives" expr:"drives"`
	Pools  []ExprOsapiSystemStoragePool  `json:"pools"  yaml:"pools" expr:"pools"`
}

type ExprServer struct {
	ID                   int64                    `json:"-" expr:"-"`
	Cluster              *string                  `json:"cluster"                db:"leftjoin=clusters.name" expr:"cluster"`
	Name                 string                   `json:"name"                   db:"primary=yes" expr:"name"`
	Type                 api.ServerType           `json:"type" expr:"type"`
	ConnectionURL        string                   `json:"connection_url" expr:"connection_url"`
	PublicConnectionURL  string                   `json:"public_connection_url" expr:"public_connection_url"`
	Certificate          string                   `json:"certificate" expr:"certificate"`
	Fingerprint          string                   `json:"fingerprint"            db:"ignore" expr:"fingerprint"`
	ClusterCertificate   *string                  `json:"cluster_certificate"    db:"omit=create,update&leftjoin=clusters.certificate" expr:"cluster_certificate"`
	ClusterConnectionURL *string                  `json:"cluster_connection_url" db:"omit=create,update&leftjoin=clusters.connection_url" expr:"cluster_connection_url"`
	HardwareData         api.HardwareData         `json:"hardware_data" expr:"hardware_data"`
	OSData               ExprApiOSData            `json:"os_data" expr:"os_data"`
	VersionData          ExprApiServerVersionData `json:"version_data" expr:"version_data"`
	Channel              string                   `json:"channel"                db:"join=channels.name" expr:"channel"`
	Status               api.ServerStatus         `json:"status" expr:"status"`
	LastUpdated          time.Time                `json:"last_updated"           db:"update_timestamp" expr:"last_updated"`
	LastSeen             time.Time                `json:"last_seen" expr:"last_seen"`
}

func ToExprApiApplicationVersionData(a api.ApplicationVersionData) ExprApiApplicationVersionData {
	return ExprApiApplicationVersionData{
		Name:             a.Name,
		Version:          a.Version,
		AvailableVersion: a.AvailableVersion,
		NeedsUpdate:      a.NeedsUpdate,
		InMaintenance:    a.InMaintenance,
	}
}

func ToExprApiOSData(o api.OSData) ExprApiOSData {
	return ExprApiOSData{
		Network:  ToExprOsapiSystemNetwork(o.Network),
		Security: ToExprOsapiSystemSecurity(o.Security),
		Storage:  ToExprOsapiSystemStorage(o.Storage),
	}
}

func ToExprApiOSVersionData(o api.OSVersionData) ExprApiOSVersionData {
	return ExprApiOSVersionData{
		Name:             o.Name,
		Version:          o.Version,
		VersionNext:      o.VersionNext,
		AvailableVersion: o.AvailableVersion,
		NeedsReboot:      o.NeedsReboot,
		NeedsUpdate:      o.NeedsUpdate,
	}
}

func ToExprApiServerVersionData(s api.ServerVersionData) ExprApiServerVersionData {
	return ExprApiServerVersionData{
		OS:            ToExprApiOSVersionData(s.OS),
		Applications:  sliceConvert(s.Applications, ToExprApiApplicationVersionData),
		UpdateChannel: s.UpdateChannel,
		NeedsUpdate:   s.NeedsUpdate,
		NeedsReboot:   s.NeedsReboot,
		InMaintenance: s.InMaintenance,
	}
}

func ToExprOsapiSystemNetwork(s osapi.SystemNetwork) ExprOsapiSystemNetwork {
	return ExprOsapiSystemNetwork{
		Config: toPtr(ToExprOsapiSystemNetworkConfig(fromPtr(s.Config))),
		State:  ToExprOsapiSystemNetworkState(s.State),
	}
}

func ToExprOsapiSystemNetworkBond(s osapi.SystemNetworkBond) ExprOsapiSystemNetworkBond {
	return ExprOsapiSystemNetworkBond{
		Addresses:         s.Addresses,
		Ethernet:          toPtr(ToExprOsapiSystemNetworkEthernet(fromPtr(s.Ethernet))),
		FirewallRules:     sliceConvert(s.FirewallRules, ToExprOsapiSystemNetworkFirewallRule),
		Hwaddr:            s.Hwaddr,
		LLDP:              s.LLDP,
		Members:           s.Members,
		Mode:              s.Mode,
		MTU:               s.MTU,
		Name:              s.Name,
		RequiredForOnline: s.RequiredForOnline,
		Roles:             s.Roles,
		Routes:            sliceConvert(s.Routes, ToExprOsapiSystemNetworkRoute),
		VLANTags:          s.VLANTags,
	}
}

func ToExprOsapiSystemNetworkConfig(s osapi.SystemNetworkConfig) ExprOsapiSystemNetworkConfig {
	return ExprOsapiSystemNetworkConfig{
		DNS:        toPtr(ToExprOsapiSystemNetworkDNS(fromPtr(s.DNS))),
		Time:       toPtr(ToExprOsapiSystemNetworkTime(fromPtr(s.Time))),
		Proxy:      toPtr(ToExprOsapiSystemNetworkProxy(fromPtr(s.Proxy))),
		Interfaces: sliceConvert(s.Interfaces, ToExprOsapiSystemNetworkInterface),
		Bonds:      sliceConvert(s.Bonds, ToExprOsapiSystemNetworkBond),
		VLANs:      sliceConvert(s.VLANs, ToExprOsapiSystemNetworkVLAN),
		Wireguard:  sliceConvert(s.Wireguard, ToExprOsapiSystemNetworkWireguard),
	}
}

func ToExprOsapiSystemNetworkDNS(s osapi.SystemNetworkDNS) ExprOsapiSystemNetworkDNS {
	return ExprOsapiSystemNetworkDNS{
		Domain:        s.Domain,
		Hostname:      s.Hostname,
		Nameservers:   s.Nameservers,
		SearchDomains: s.SearchDomains,
	}
}

func ToExprOsapiSystemNetworkEthernet(s osapi.SystemNetworkEthernet) ExprOsapiSystemNetworkEthernet {
	return ExprOsapiSystemNetworkEthernet{
		DisableEnergyEfficient: s.DisableEnergyEfficient,
		DisableGRO:             s.DisableGRO,
		DisableGSO:             s.DisableGSO,
		DisableIPv4TSO:         s.DisableIPv4TSO,
		DisableIPv6TSO:         s.DisableIPv6TSO,
		WakeOnLAN:              s.WakeOnLAN,
		WakeOnLANModes:         s.WakeOnLANModes,
		WakeOnLANPassword:      s.WakeOnLANPassword,
	}
}

func ToExprOsapiSystemNetworkFirewallRule(s osapi.SystemNetworkFirewallRule) ExprOsapiSystemNetworkFirewallRule {
	return ExprOsapiSystemNetworkFirewallRule{
		Action:   s.Action,
		Source:   s.Source,
		Protocol: s.Protocol,
		Port:     s.Port,
	}
}

func ToExprOsapiSystemNetworkInterface(s osapi.SystemNetworkInterface) ExprOsapiSystemNetworkInterface {
	return ExprOsapiSystemNetworkInterface{
		Addresses:         s.Addresses,
		Ethernet:          toPtr(ToExprOsapiSystemNetworkEthernet(fromPtr(s.Ethernet))),
		FirewallRules:     sliceConvert(s.FirewallRules, ToExprOsapiSystemNetworkFirewallRule),
		Hwaddr:            s.Hwaddr,
		LLDP:              s.LLDP,
		MTU:               s.MTU,
		Name:              s.Name,
		RequiredForOnline: s.RequiredForOnline,
		Roles:             s.Roles,
		Routes:            sliceConvert(s.Routes, ToExprOsapiSystemNetworkRoute),
		StrictHwaddr:      s.StrictHwaddr,
		VLANTags:          s.VLANTags,
	}
}

func ToExprOsapiSystemNetworkInterfaceState(s osapi.SystemNetworkInterfaceState) ExprOsapiSystemNetworkInterfaceState {
	return ExprOsapiSystemNetworkInterfaceState{
		Addresses: s.Addresses,
		Hwaddr:    s.Hwaddr,
		LACP:      toPtr(ToExprOsapiSystemNetworkLACPState(fromPtr(s.LACP))),
		LLDP:      sliceConvert(s.LLDP, ToExprOsapiSystemNetworkLLDPState),
		Members:   mapConvert(s.Members, ToExprOsapiSystemNetworkInterfaceState),
		MTU:       s.MTU,
		Roles:     s.Roles,
		Routes:    sliceConvert(s.Routes, ToExprOsapiSystemNetworkRoute),
		Speed:     s.Speed,
		State:     s.State,
		Stats:     ToExprOsapiSystemNetworkInterfaceStats(s.Stats),
		Type:      s.Type,
		Wireguard: toPtr(ToExprOsapiSystemNetworkWireguardState(fromPtr(s.Wireguard))),
	}
}

func ToExprOsapiSystemNetworkInterfaceStats(s osapi.SystemNetworkInterfaceStats) ExprOsapiSystemNetworkInterfaceStats {
	return ExprOsapiSystemNetworkInterfaceStats{
		RXBytes:  s.RXBytes,
		RXErrors: s.RXErrors,
		TXBytes:  s.TXBytes,
		TXErrors: s.TXErrors,
	}
}

func ToExprOsapiSystemNetworkLACPState(s osapi.SystemNetworkLACPState) ExprOsapiSystemNetworkLACPState {
	return ExprOsapiSystemNetworkLACPState{
		LocalMAC:  s.LocalMAC,
		RemoteMAC: s.RemoteMAC,
	}
}

func ToExprOsapiSystemNetworkLLDPState(s osapi.SystemNetworkLLDPState) ExprOsapiSystemNetworkLLDPState {
	return ExprOsapiSystemNetworkLLDPState{
		ChassisID: s.ChassisID,
		Name:      s.Name,
		PortID:    s.PortID,
		Port:      s.Port,
	}
}

func ToExprOsapiSystemNetworkProxy(s osapi.SystemNetworkProxy) ExprOsapiSystemNetworkProxy {
	return ExprOsapiSystemNetworkProxy{
		Rules:   sliceConvert(s.Rules, ToExprOsapiSystemNetworkProxyRule),
		Servers: mapConvert(s.Servers, ToExprOsapiSystemNetworkProxyServer),
	}
}

func ToExprOsapiSystemNetworkProxyRule(s osapi.SystemNetworkProxyRule) ExprOsapiSystemNetworkProxyRule {
	return ExprOsapiSystemNetworkProxyRule{
		Destination: s.Destination,
		Target:      s.Target,
	}
}

func ToExprOsapiSystemNetworkProxyServer(s osapi.SystemNetworkProxyServer) ExprOsapiSystemNetworkProxyServer {
	return ExprOsapiSystemNetworkProxyServer{
		Auth:     s.Auth,
		Host:     s.Host,
		Password: s.Password,
		Realm:    s.Realm,
		Username: s.Username,
		UseTLS:   s.UseTLS,
	}
}

func ToExprOsapiSystemNetworkRoute(s osapi.SystemNetworkRoute) ExprOsapiSystemNetworkRoute {
	return ExprOsapiSystemNetworkRoute{
		To:  s.To,
		Via: s.Via,
	}
}

func ToExprOsapiSystemNetworkState(s osapi.SystemNetworkState) ExprOsapiSystemNetworkState {
	return ExprOsapiSystemNetworkState{
		Interfaces: mapConvert(s.Interfaces, ToExprOsapiSystemNetworkInterfaceState),
	}
}

func ToExprOsapiSystemNetworkTime(s osapi.SystemNetworkTime) ExprOsapiSystemNetworkTime {
	return ExprOsapiSystemNetworkTime{
		NTPServers: s.NTPServers,
		Timezone:   s.Timezone,
	}
}

func ToExprOsapiSystemNetworkVLAN(s osapi.SystemNetworkVLAN) ExprOsapiSystemNetworkVLAN {
	return ExprOsapiSystemNetworkVLAN{
		Addresses:         s.Addresses,
		FirewallRules:     sliceConvert(s.FirewallRules, ToExprOsapiSystemNetworkFirewallRule),
		ID:                s.ID,
		MTU:               s.MTU,
		Name:              s.Name,
		Parent:            s.Parent,
		RequiredForOnline: s.RequiredForOnline,
		Roles:             s.Roles,
		Routes:            sliceConvert(s.Routes, ToExprOsapiSystemNetworkRoute),
	}
}

func ToExprOsapiSystemNetworkWireguard(s osapi.SystemNetworkWireguard) ExprOsapiSystemNetworkWireguard {
	return ExprOsapiSystemNetworkWireguard{
		Addresses:         s.Addresses,
		FirewallRules:     sliceConvert(s.FirewallRules, ToExprOsapiSystemNetworkFirewallRule),
		MTU:               s.MTU,
		Name:              s.Name,
		Peers:             sliceConvert(s.Peers, ToExprOsapiSystemNetworkWireguardPeer),
		Port:              s.Port,
		PrivateKey:        s.PrivateKey,
		RequiredForOnline: s.RequiredForOnline,
		Roles:             s.Roles,
		Routes:            sliceConvert(s.Routes, ToExprOsapiSystemNetworkRoute),
	}
}

func ToExprOsapiSystemNetworkWireguardPeer(s osapi.SystemNetworkWireguardPeer) ExprOsapiSystemNetworkWireguardPeer {
	return ExprOsapiSystemNetworkWireguardPeer{
		AllowedIPs:          s.AllowedIPs,
		Endpoint:            s.Endpoint,
		PersistentKeepalive: s.PersistentKeepalive,
		PresharedKey:        s.PresharedKey,
		PublicKey:           s.PublicKey,
	}
}

func ToExprOsapiSystemNetworkWireguardPeerState(s osapi.SystemNetworkWireguardPeerState) ExprOsapiSystemNetworkWireguardPeerState {
	return ExprOsapiSystemNetworkWireguardPeerState{
		AllowedIPs:          s.AllowedIPs,
		EndPoint:            s.EndPoint,
		LatestHandshake:     s.LatestHandshake,
		PersistentKeepalive: s.PersistentKeepalive,
		PublicKey:           s.PublicKey,
		Stats:               ToExprOsapiSystemNetworkInterfaceStats(s.Stats),
	}
}

func ToExprOsapiSystemNetworkWireguardState(s osapi.SystemNetworkWireguardState) ExprOsapiSystemNetworkWireguardState {
	return ExprOsapiSystemNetworkWireguardState{
		ListeningPort: s.ListeningPort,
		Peers:         sliceConvert(s.Peers, ToExprOsapiSystemNetworkWireguardPeerState),
		PublicKey:     s.PublicKey,
	}
}

func ToExprOsapiSystemSecurity(s osapi.SystemSecurity) ExprOsapiSystemSecurity {
	return ExprOsapiSystemSecurity{
		Config: ToExprOsapiSystemSecurityConfig(s.Config),
		State:  ToExprOsapiSystemSecurityState(s.State),
	}
}

func ToExprOsapiSystemSecurityConfig(s osapi.SystemSecurityConfig) ExprOsapiSystemSecurityConfig {
	return ExprOsapiSystemSecurityConfig{
		CustomCACerts:          s.CustomCACerts,
		EncryptionRecoveryKeys: s.EncryptionRecoveryKeys,
	}
}

func ToExprOsapiSystemSecurityEncryptedVolume(s osapi.SystemSecurityEncryptedVolume) ExprOsapiSystemSecurityEncryptedVolume {
	return ExprOsapiSystemSecurityEncryptedVolume{
		Volume: s.Volume,
		State:  s.State,
	}
}

func ToExprOsapiSystemSecuritySecureBootCertificate(s osapi.SystemSecuritySecureBootCertificate) ExprOsapiSystemSecuritySecureBootCertificate {
	return ExprOsapiSystemSecuritySecureBootCertificate{
		Type:        s.Type,
		Fingerprint: s.Fingerprint,
		Subject:     s.Subject,
		Issuer:      s.Issuer,
	}
}

func ToExprOsapiSystemSecurityState(s osapi.SystemSecurityState) ExprOsapiSystemSecurityState {
	return ExprOsapiSystemSecurityState{
		EncryptedVolumes:                sliceConvert(s.EncryptedVolumes, ToExprOsapiSystemSecurityEncryptedVolume),
		EncryptionRecoveryKeysRetrieved: s.EncryptionRecoveryKeysRetrieved,
		DriveRecoveryKeys:               s.DriveRecoveryKeys,
		PoolRecoveryKeys:                s.PoolRecoveryKeys,
		SecureBootCertificates:          sliceConvert(s.SecureBootCertificates, ToExprOsapiSystemSecuritySecureBootCertificate),
		SecureBootEnabled:               s.SecureBootEnabled,
		SystemStateIsTrusted:            s.SystemStateIsTrusted,
		TPMStatus:                       s.TPMStatus,
	}
}

func ToExprOsapiSystemStorage(s osapi.SystemStorage) ExprOsapiSystemStorage {
	return ExprOsapiSystemStorage{
		Config: ToExprOsapiSystemStorageConfig(s.Config),
		State:  ToExprOsapiSystemStorageState(s.State),
	}
}

func ToExprOsapiSystemStorageConfig(s osapi.SystemStorageConfig) ExprOsapiSystemStorageConfig {
	return ExprOsapiSystemStorageConfig{
		ScrubSchedule: s.ScrubSchedule,
		Pools:         sliceConvert(s.Pools, ToExprOsapiSystemStoragePool),
	}
}

func ToExprOsapiSystemStorageDrive(s osapi.SystemStorageDrive) ExprOsapiSystemStorageDrive {
	return ExprOsapiSystemStorageDrive{
		ID:              s.ID,
		ModelFamily:     s.ModelFamily,
		ModelName:       s.ModelName,
		SerialNumber:    s.SerialNumber,
		Bus:             s.Bus,
		CapacityInBytes: s.CapacityInBytes,
		Boot:            s.Boot,
		Removable:       s.Removable,
		Remote:          s.Remote,
		WWN:             s.WWN,
		SMART:           toPtr(ToExprOsapiSystemStorageDriveSMART(fromPtr(s.SMART))),
		MemberPool:      s.MemberPool,
		Encrypted:       s.Encrypted,
		EncryptedID:     s.EncryptedID,
	}
}

func ToExprOsapiSystemStorageDriveSMART(s osapi.SystemStorageDriveSMART) ExprOsapiSystemStorageDriveSMART {
	return ExprOsapiSystemStorageDriveSMART{
		Enabled:            s.Enabled,
		Passed:             s.Passed,
		Error:              s.Error,
		PowerOnHours:       s.PowerOnHours,
		DataUnitsRead:      s.DataUnitsRead,
		DataUnitsWritten:   s.DataUnitsWritten,
		AvailableSpare:     s.AvailableSpare,
		PercentageUsed:     s.PercentageUsed,
		RawReadErrorRate:   s.RawReadErrorRate,
		SeekErrorRate:      s.SeekErrorRate,
		ReallocatedSectors: s.ReallocatedSectors,
	}
}

func ToExprOsapiSystemStoragePool(s osapi.SystemStoragePool) ExprOsapiSystemStoragePool {
	return ExprOsapiSystemStoragePool{
		Name:                      s.Name,
		Type:                      s.Type,
		Devices:                   s.Devices,
		Cache:                     s.Cache,
		Log:                       s.Log,
		State:                     s.State,
		LastScrub:                 toPtr(ToExprOsapiSystemStoragePoolScrubStatus(fromPtr(s.LastScrub))),
		EncryptionKeyStatus:       s.EncryptionKeyStatus,
		DevicesDegraded:           s.DevicesDegraded,
		CacheDegraded:             s.CacheDegraded,
		LogDegraded:               s.LogDegraded,
		RawPoolSizeInBytes:        s.RawPoolSizeInBytes,
		UsablePoolSizeInBytes:     s.UsablePoolSizeInBytes,
		PoolAllocatedSpaceInBytes: s.PoolAllocatedSpaceInBytes,
		Volumes:                   sliceConvert(s.Volumes, ToExprOsapiSystemStoragePoolVolume),
	}
}

func ToExprOsapiSystemStoragePoolScrubStatus(s osapi.SystemStoragePoolScrubStatus) ExprOsapiSystemStoragePoolScrubStatus {
	return ExprOsapiSystemStoragePoolScrubStatus{
		State:     s.State,
		StartTime: s.StartTime,
		EndTime:   s.EndTime,
		Progress:  s.Progress,
		Errors:    s.Errors,
	}
}

func ToExprOsapiSystemStoragePoolVolume(s osapi.SystemStoragePoolVolume) ExprOsapiSystemStoragePoolVolume {
	return ExprOsapiSystemStoragePoolVolume{
		Name:         s.Name,
		UsageInBytes: s.UsageInBytes,
		QuotaInBytes: s.QuotaInBytes,
		Use:          s.Use,
	}
}

func ToExprOsapiSystemStorageState(s osapi.SystemStorageState) ExprOsapiSystemStorageState {
	return ExprOsapiSystemStorageState{
		Drives: sliceConvert(s.Drives, ToExprOsapiSystemStorageDrive),
		Pools:  sliceConvert(s.Pools, ToExprOsapiSystemStoragePool),
	}
}

func ToExprServer(s Server) ExprServer {
	return ExprServer{
		ID:                   s.ID,
		Cluster:              s.Cluster,
		Name:                 s.Name,
		Type:                 s.Type,
		ConnectionURL:        s.ConnectionURL,
		PublicConnectionURL:  s.PublicConnectionURL,
		Certificate:          s.Certificate,
		Fingerprint:          s.Fingerprint,
		ClusterCertificate:   s.ClusterCertificate,
		ClusterConnectionURL: s.ClusterConnectionURL,
		HardwareData:         s.HardwareData,
		OSData:               ToExprApiOSData(s.OSData),
		VersionData:          ToExprApiServerVersionData(s.VersionData),
		Channel:              s.Channel,
		Status:               s.Status,
		LastUpdated:          s.LastUpdated,
		LastSeen:             s.LastSeen,
	}
}
